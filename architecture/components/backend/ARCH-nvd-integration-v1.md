---
id: ARCH-nvd-integration
title: "Компонент: Інтеграція з NVD API"
type: service_integration
layer: infrastructure
owner: "@AI-DocArchitect"
version: v1
status: current
created: 2025-06-02
updated: 2025-06-02
tags: [backend, reconnaissance, cve, nvd, api, vulnerability]
depends_on:
  - ARCH-config
referenced_by: []
---
## Контекст
Цей компонент, реалізований в рамках модуля розвідки, відповідає за взаємодію з National Vulnerability Database (NVD) API 2.0 для отримання інформації про відомі вразливості (CVE). Це дозволяє збагачувати результати сканування Nmap даними про потенційні ризики безпеки.

## Структура
Основна логіка знаходиться у функції `fetch_cves_from_nvd_api_logic` в файлі `CYBER_DASHBOARD_BACKEND/reconnaissance/logic.py`.

Ключові аспекти:
- Використання конфігураційних параметрів з `config.py` (`NVD_API_BASE_URL`, `NVD_API_KEY`, `NVD_REQUEST_TIMEOUT_SECONDS`, `NVD_RESULTS_PER_PAGE`).
- Формування запитів до NVD API на основі CPE (Common Platform Enumeration) ідентифікаторів або ключових слів сервісу.
- Обробка JSON-відповіді від NVD API.
- Парсинг даних CVE, включаючи ID, опис, рейтинг CVSS (v2, v3.x), дати, посилання та конфігурації, яких стосується вразливість.
- Обробка можливих помилок запитів та обмежень API (наприклад, затримка між запитами).

## Поведінка
1.  Компонент отримує на вхід ключові слова сервісу (наприклад, "apache httpd 2.4.53") та/або список CPE.
2.  Формує HTTP GET-запити до NVD API, використовуючи надані дані як параметри пошуку.
3.  Якщо доступний `NVD_API_KEY`, він додається до заголовків запиту.
4.  Отримує та розбирає JSON-відповідь.
5.  Витягує релевантну інформацію для кожної знайденої вразливості та форматує її у стандартизований вигляд.
6.  Повертає список знайдених CVE.

## Еволюція
### Заплановано
- Покращення стратегії запитів для зменшення кількості звернень до API.
- Більш глибокий аналіз зв'язків між CVE та конфігураціями.
### Історичне
- v1: Реалізація базової взаємодії з NVD API 2.0 для пошуку CVE за CPE та ключовими словами. 