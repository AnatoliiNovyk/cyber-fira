---
id: TASK-2025-004
title: "Реалізація модуля управління C2 (Командування та Контроль)"
status: done
priority: high
type: feature
assignee: "@AI-DocArchitect"
created: 2025-06-02
updated: 2025-06-02
arch_refs:
  - ARCH-module-c2-control
  - ARCH-config
audit_log:
  - {date: 2025-06-02, user: "@AI-DocArchitect", action: "created with status done"}
---
## Опис
Було реалізовано модуль C2 (Командування та Контроль) для backend. Модуль симулює взаємодію з імплантами, обробляє їхні маячки, дозволяє ставити завдання, отримувати результати, керувати списком симульованих імплантів та підтримує концептуальну симуляцію DNS C2. Стан C2 (список імплантів, черги завдань, дані ексфільтрації) зберігається в пам'яті.

## Критерії Приймання
- Модуль доступний через API ендпоінти:
    - `POST /api/c2/beacon_receiver`: для прийому HTTP-маячків від імплантів.
    - `GET /api/c2/dns_resolver_sim`: для симуляції DNS C2.
    - `GET /api/c2/implants`: для отримання списку симульованих імплантів.
    - `POST /api/c2/task`: для постановки завдань імплантам.
- При старті модуля ініціалізується список симульованих імплантів (`initialize_simulated_implants_c2_logic`).
- Обробка маячків (`handle_c2_beacon_logic`) включає:
    - Оновлення статусу імпланта (lastSeen, IP, статус).
    - Обробку результатів попереднього завдання.
    - Обробку частин файлів, що ексфільтруються.
    - Видачу нового завдання з черги, якщо є.
- Реалізовано постановку завдань у чергу для конкретного імпланта (`handle_c2_task_logic`).
- Реалізовано симуляцію DNS C2 (`handle_dns_resolver_sim_logic`), що дозволяє імпланту отримувати завдання через DNS-подібні запити.
- Надається список імплантів (`get_c2_implants_logic`) з актуальними статусами (включаючи `offline_timeout`).
- Логіка C2 винесена у файли `c2_control/logic.py` та `c2_control/routes.py`.

## Визначення Готовності
- Код модуля реалізовано та інтегровано в основний додаток.
- Всі заявлені API ендпоінти та основні функції C2 працюють.

## Нотатки
- Поточна реалізація зберігає весь стан C2 в пам'яті, що означає втрату даних при перезапуску сервера. 